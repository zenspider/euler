(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     13723,        384]
NotebookOptionsPosition[     12426,        334]
NotebookOutlinePosition[     12781,        350]
CellTagsIndexPosition[     12738,        347]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Problem 145", "Section",
 CellChangeTimes->{
  3.53082773044563*^9, {3.530827780536021*^9, 3.5308278112139683`*^9}, {
   3.530828168456216*^9, 3.5308281799103823`*^9}, {3.530828598820354*^9, 
   3.530828737824876*^9}, {3.5315460042336483`*^9, 3.5315460967150173`*^9}, {
   3.531546410774343*^9, 3.5315464562157927`*^9}, {3.53215071713129*^9, 
   3.5321507379917383`*^9}, {3.532151642575706*^9, 3.532151647903137*^9}}],

Cell["\<\

Some positive integers n have the property that the sum [ n + reverse(n) ] \
consists entirely of odd (decimal) digits. For instance, 36 + 63 = 99 and 409 \
+ 904 = 1313. We will call such numbers reversible; so 36, 63, 409, and 904 \
are reversible. Leading zeroes are not allowed in either n or reverse(n).

There are 120 reversible numbers below one-thousand.

How many reversible numbers are there below one-billion (109)?\
\>", "Text",
 CellChangeTimes->{
  3.53082773044563*^9, {3.530827780536021*^9, 3.5308278112139683`*^9}, {
   3.530828168456216*^9, 3.5308281799103823`*^9}, {3.530828598820354*^9, 
   3.530828737824876*^9}, {3.5315460042336483`*^9, 3.5315460967150173`*^9}, {
   3.531546410774343*^9, 3.5315464562157927`*^9}, {3.53215071713129*^9, 
   3.5321507379917383`*^9}, {3.532151642575706*^9, 3.532151647903137*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "l_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Do", "[", 
   RowBox[{
    TagBox[
     FrameBox["expr"],
     "Placeholder"], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "10000", ",", 
      RowBox[{"20000", "-", "1"}], ",", "2"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.53499361019442*^9, 3.534993624688943*^9}, {
  3.53499369534763*^9, 3.534993700464363*^9}, {3.534993740809617*^9, 
  3.5349937533695507`*^9}, {3.534993800418419*^9, 3.534993808571862*^9}, {
  3.534993916389571*^9, 3.53499393660073*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", 
          RowBox[{"x", "+", "y"}], ",", 
          RowBox[{"OddQ", "[", 
           RowBox[{"x", "+", "y"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "9"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "0", ",", "9"}], "}"}]}], "]"}], ",", "1"}], "]"}],
     ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], "&&", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", "0"}], "&&", 
      RowBox[{"OddQ", "[", 
       RowBox[{"#", "\[LeftDoubleBracket]", 
        RowBox[{"-", "2"}], "\[RightDoubleBracket]"}], "]"}]}], "&"}]}], 
   "]"}], "//", "Length"}]], "Input",
 CellChangeTimes->{{3.534994067249825*^9, 3.534994140610249*^9}, {
  3.534994248340159*^9, 3.53499429451178*^9}, {3.5349943778455877`*^9, 
  3.5349943931034*^9}, {3.534994424161936*^9, 3.534994429217828*^9}, {
  3.534996485608021*^9, 3.53499648676958*^9}}],

Cell[BoxData["40"], "Output",
 CellChangeTimes->{{3.534994091154373*^9, 3.534994140899548*^9}, {
   3.534994259023979*^9, 3.534994294873163*^9}, 3.534994394278379*^9, {
   3.53499442575751*^9, 3.53499442977592*^9}, 3.53499648704428*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.534994549567274*^9, 3.5349945818549557`*^9}, 
   3.534994624586281*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.534994582417864*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"Xor", "[", 
    RowBox[{
     RowBox[{"OddQ", "[", 
      RowBox[{"First", "[", "l", "]"}], "]"}], ",", 
     RowBox[{"OddQ", "[", 
      RowBox[{"Last", "[", "l", "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"f", "[", "l", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.534994620055925*^9, 3.534994648029722*^9}}],

Cell[BoxData[
 RowBox[{"n", "+", 
  RowBox[{"FromDigits", "@", 
   RowBox[{"Reverse", "@", 
    RowBox[{"IntegerDigits", "[", "n", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.534994702556507*^9, 3.534994720486491*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"N", "+", 
    RowBox[{"Rev", 
     RowBox[{"(", "N", ")"}]}]}], "=", 
   RowBox[{"sum_", 
    RowBox[{"{", 
     RowBox[{"i", "=", 
      RowBox[{
       RowBox[{"0", "..."}], "k"}]}], "}"}], " ", 
    RowBox[{"(", 
     RowBox[{"ai", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"10", "^", "i"}], "+", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"k", "-", "i"}], ")"}]}]}], ")"}]}], ")"}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.534997547116727*^9, 3.534997550779994*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "f", "]"}], "\n", 
 RowBox[{
  RowBox[{"f", "[", "n_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"IntegerDigits", "[", "n", "]"}]}], ",", 
      RowBox[{"k", "=", 
       RowBox[{"IntegerLength", "[", "n", "]"}]}]}], "}"}], ",", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", "i", "k"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "\[LeftDoubleBracket]", 
         RowBox[{"k", "-", "i", "+", "1"}], "\[RightDoubleBracket]"}], " ", 
        SuperscriptBox["10", 
         RowBox[{"i", "-", "1"}]]}], "+", 
       RowBox[{
        RowBox[{"a", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
        " ", 
        SuperscriptBox["10", 
         RowBox[{"i", "-", "1"}]]}]}], ")"}]}]}], "]"}]}], "\n", 
 RowBox[{"f", "[", "52918", "]"}]}], "Input",
 CellChangeTimes->{{3.534997588534833*^9, 3.53499763895086*^9}, {
  3.535000807622224*^9, 3.535000887113765*^9}, {3.535000923148395*^9, 
  3.5350009261814632`*^9}, {3.535002977740945*^9, 3.535002986063755*^9}, {
  3.535003072369598*^9, 3.535003081539065*^9}}],

Cell[BoxData["134843"], "Output",
 CellChangeTimes->{{3.535000847866454*^9, 3.5350008736283216`*^9}, 
   3.5350009312136183`*^9, {3.5350029837847633`*^9, 3.5350029865394278`*^9}, {
   3.535003074912046*^9, 3.535003081924911*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"f", "[", "n", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "100000", ",", "200000"}], "}"}]}], "]"}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5350033776547728`*^9, 3.535003397543195*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.898033000000055`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.535003391664638*^9, 3.535003403928735*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"reverse", "[", "n_", "]"}], ":=", 
  RowBox[{"FromDigits", "@", 
   RowBox[{"Reverse", "@", 
    RowBox[{"IntegerDigits", "@", "n"}]}]}]}]], "Input",
 CellChangeTimes->{{3.534995315309894*^9, 3.5349953318092813`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NestList", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "+", 
     RowBox[{"reverse", "@", "#"}]}], "&"}], ",", "1", ",", "30"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5349950566649237`*^9, 3.5349950601405497`*^9}, {
   3.534995263247243*^9, 3.534995269291428*^9}, 3.534995345305464*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "2", ",", "4", ",", "8", ",", "16", ",", "77", ",", "154", ",", 
   "605", ",", "1111", ",", "2222", ",", "4444", ",", "8888", ",", "17776", 
   ",", "85547", ",", "160105", ",", "661166", ",", "1322332", ",", "3654563",
    ",", "7309126", ",", "13528163", ",", "49710694", ",", "99312488", ",", 
   "187733887", ",", "976071668", ",", "1842242347", ",", "9274664828", ",", 
   "17559329557", ",", "93151725128", ",", "175304440267", ",", 
   "937348843838", ",", "1775697687577"}], "}"}]], "Output",
 CellChangeTimes->{
  3.53499506270054*^9, {3.534995263726021*^9, 3.534995269675436*^9}, 
   3.534995348777844*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Union", "@", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"NestList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "+", 
         RowBox[{"reverse", "@", "#"}]}], "&"}], ",", "n", ",", "26"}], "]"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "10"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5349951588985853`*^9, 3.534995212928029*^9}, 
   3.5349953430670233`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", "8", 
   ",", "9", ",", "10", ",", "11", ",", "12", ",", "14", ",", "16", ",", "18",
    ",", "22", ",", "33", ",", "44", ",", "55", ",", "66", ",", "77", ",", 
   "88", ",", "99", ",", "110", ",", "121", ",", "132", ",", "154", ",", 
   "176", ",", "198", ",", "242", ",", "363", ",", "484", ",", "605", ",", 
   "726", ",", "847", ",", "968", ",", "1089", ",", "1111", ",", "1353", ",", 
   "1595", ",", "1837", ",", "2222", ",", "4444", ",", "4884", ",", "7546", 
   ",", "8888", ",", "9218", ",", "9768", ",", "10890", ",", "14003", ",", 
   "17347", ",", "17776", ",", "18447", ",", "20691", ",", "40293", ",", 
   "44044", ",", "79497", ",", "85547", ",", "88088", ",", "91718", ",", 
   "92928", ",", "158994", ",", "160105", ",", "173437", ",", "175857", ",", 
   "176176", ",", "658845", ",", "661166", ",", "847847", ",", "907808", ",", 
   "934428", ",", "1207701", ",", "1322332", ",", "1596595", ",", "1716517", 
   ",", "1758867", ",", "2284722", ",", "3654563", ",", "4559544", ",", 
   "7309126", ",", "7553546", ",", "8872688", ",", "9019098", ",", "9447438", 
   ",", "13528163", ",", "14007103", ",", "17735476", ",", "17794887", ",", 
   "17928207", ",", "44177144", ",", "49710694", ",", "85189247", ",", 
   "88211178", ",", "88354288", ",", "96644658", ",", "99312488", ",", 
   "159487405", ",", "175322466", ",", "176599676", ",", "182289327", ",", 
   "187733887", ",", "664272356", ",", "839546037", ",", "853595347", ",", 
   "906271608", ",", "976071668", ",", "1317544822", ",", "1570191975", ",", 
   "1597190705", ",", "1712444217", ",", "1842242347", ",", "3602001953", ",",
    "6668108656", ",", "7193004016", ",", "7362102726", ",", "8836886388", 
   ",", "9274664828", ",", "13236127322", ",", "13297007933", ",", 
   "13634115363", ",", "17559329557", ",", "17673772776", ",", "35608290553", 
   ",", "47267087164", ",", "49985258994", ",", "71117571206", ",", 
   "85401510447", ",", "93151725128", ",", "93445163438", ",", "99970517988", 
   ",", "131335142323", ",", "159803020905", ",", "175304440267", ",", 
   "176881317877", ",", "188942025987", ",", "668823329856", ",", 
   "937348843838", ",", "978462275868", ",", "1327746658722", ",", 
   "1847034540747"}], "}"}]], "Output",
 CellChangeTimes->{{3.534995182659006*^9, 3.53499521331044*^9}, 
   3.534995353996954*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NestList", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "+", 
     RowBox[{"reverse", "@", "#"}]}], "&"}], ",", "1", ",", "30"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.534995258169347*^9, 3.5349952581709433`*^9}, {
  3.534995336723647*^9, 3.53499533836775*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "2", ",", "4", ",", "8", ",", "16", ",", "77", ",", "154", ",", 
   "605", ",", "1111", ",", "2222", ",", "4444", ",", "8888", ",", "17776", 
   ",", "85547", ",", "160105", ",", "661166", ",", "1322332", ",", "3654563",
    ",", "7309126", ",", "13528163", ",", "49710694", ",", "99312488", ",", 
   "187733887", ",", "976071668", ",", "1842242347", ",", "9274664828", ",", 
   "17559329557", ",", "93151725128", ",", "175304440267", ",", 
   "937348843838", ",", "1775697687577"}], "}"}]], "Output",
 CellChangeTimes->{3.5349952594965677`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{740, 752},
WindowMargins->{{Automatic, 294}, {Automatic, 0}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 423, 6, 67, "Section"],
Cell[1005, 30, 844, 16, 131, "Text"],
Cell[1852, 48, 571, 14, 49, "Input"],
Cell[CellGroupData[{
Cell[2448, 66, 1220, 33, 43, "Input"],
Cell[3671, 101, 236, 3, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3944, 109, 120, 2, 27, "Input"],
Cell[4067, 113, 73, 1, 27, "Output"]
}, Open  ]],
Cell[4155, 117, 368, 10, 27, "Input"],
Cell[4526, 129, 219, 5, 27, "Input"],
Cell[4748, 136, 573, 20, 27, "Input"],
Cell[CellGroupData[{
Cell[5346, 160, 1166, 30, 118, "Input"],
Cell[6515, 192, 229, 3, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6781, 200, 310, 9, 27, "Input"],
Cell[7094, 211, 159, 3, 27, "Output"]
}, Open  ]],
Cell[7268, 217, 252, 6, 27, "Input"],
Cell[CellGroupData[{
Cell[7545, 227, 316, 8, 27, "Input"],
Cell[7864, 237, 669, 12, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8570, 254, 470, 14, 27, "Input"],
Cell[9043, 270, 2428, 35, 238, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11508, 310, 290, 8, 27, "Input"],
Cell[11801, 320, 597, 10, 73, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

